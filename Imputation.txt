> missing <- data.frame(is.na(mydat$Fare))
> missing
    is.na.mydat.Fare.
1               FALSE
2               FALSE
3               FALSE
4               FALSE
5               FALSE
6               FALSE
7               FALSE
8               FALSE
9               FALSE
10              FALSE
11              FALSE
12              FALSE
13              FALSE
14              FALSE
15              FALSE
16              FALSE
17              FALSE
18              FALSE
19              FALSE
20              FALSE
21              FALSE
22              FALSE
23              FALSE
24              FALSE
25              FALSE
26              FALSE
27              FALSE
28              FALSE
29              FALSE
30              FALSE
31              FALSE
32              FALSE
33              FALSE
34              FALSE
35              FALSE
36              FALSE
37              FALSE
38              FALSE
39              FALSE
40              FALSE
41              FALSE
42              FALSE
43              FALSE
44              FALSE
45              FALSE
46              FALSE
47              FALSE
48              FALSE
49              FALSE
50              FALSE
51              FALSE
52              FALSE
53              FALSE
54              FALSE
55              FALSE
56              FALSE
57              FALSE
58              FALSE
59              FALSE
60              FALSE
61              FALSE
62              FALSE
63              FALSE
64              FALSE
65              FALSE
66              FALSE
67              FALSE
68              FALSE
69              FALSE
70              FALSE
71              FALSE
72              FALSE
73              FALSE
74              FALSE
75              FALSE
76              FALSE
77              FALSE
78              FALSE
79              FALSE
80              FALSE
81              FALSE
82              FALSE
83              FALSE
84              FALSE
85              FALSE
86              FALSE
87              FALSE
88              FALSE
89              FALSE
90              FALSE
91              FALSE
92              FALSE
93              FALSE
94              FALSE
95              FALSE
96              FALSE
97              FALSE
98              FALSE
99              FALSE
100             FALSE
101             FALSE
102             FALSE
103             FALSE
104             FALSE
105             FALSE
106             FALSE
107             FALSE
108             FALSE
109             FALSE
110             FALSE
111             FALSE
112             FALSE
113             FALSE
114             FALSE
115             FALSE
116             FALSE
117             FALSE
118             FALSE
119             FALSE
120             FALSE
121             FALSE
122             FALSE
123             FALSE
124             FALSE
125             FALSE
126             FALSE
127             FALSE
128             FALSE
129             FALSE
130             FALSE
131             FALSE
132             FALSE
133             FALSE
134             FALSE
135             FALSE
136             FALSE
137             FALSE
138             FALSE
139             FALSE
140             FALSE
141             FALSE
142             FALSE
143             FALSE
144             FALSE
145             FALSE
146             FALSE
147             FALSE
148             FALSE
149             FALSE
150             FALSE
151             FALSE
152             FALSE
153              TRUE
154             FALSE
155             FALSE
156             FALSE
157             FALSE
158             FALSE
159             FALSE
160             FALSE
161             FALSE
162             FALSE
163             FALSE
164             FALSE
165             FALSE
166             FALSE
167             FALSE
168             FALSE
169             FALSE
170             FALSE
171             FALSE
172             FALSE
173             FALSE
174             FALSE
175             FALSE
176             FALSE
177             FALSE
178             FALSE
179             FALSE
180             FALSE
181             FALSE
182             FALSE
183             FALSE
184             FALSE
185             FALSE
186             FALSE
187             FALSE
188             FALSE
189             FALSE
190             FALSE
191             FALSE
192             FALSE
193             FALSE
194             FALSE
195             FALSE
196             FALSE
197             FALSE
198             FALSE
199             FALSE
200             FALSE
201             FALSE
202             FALSE
203             FALSE
204             FALSE
205             FALSE
206             FALSE
207             FALSE
208             FALSE
209             FALSE
210             FALSE
211             FALSE
212             FALSE
213             FALSE
214             FALSE
215             FALSE
216             FALSE
217             FALSE
218             FALSE
219             FALSE
220             FALSE
221             FALSE
222             FALSE
223             FALSE
224             FALSE
225             FALSE
226             FALSE
227             FALSE
228             FALSE
229             FALSE
230             FALSE
231             FALSE
232             FALSE
233             FALSE
234             FALSE
235             FALSE
236             FALSE
237             FALSE
238             FALSE
239             FALSE
240             FALSE
241             FALSE
242             FALSE
243             FALSE
244             FALSE
245             FALSE
246             FALSE
247             FALSE
248             FALSE
249             FALSE
250             FALSE
251             FALSE
252             FALSE
253             FALSE
254             FALSE
255             FALSE
256             FALSE
257             FALSE
258             FALSE
259             FALSE
260             FALSE
261             FALSE
262             FALSE
263             FALSE
264             FALSE
265             FALSE
266             FALSE
267             FALSE
268             FALSE
269             FALSE
270             FALSE
271             FALSE
272             FALSE
273             FALSE
274             FALSE
275             FALSE
276             FALSE
277             FALSE
278             FALSE
279             FALSE
280             FALSE
281             FALSE
282             FALSE
283             FALSE
284             FALSE
285             FALSE
286             FALSE
287             FALSE
288             FALSE
289             FALSE
290             FALSE
291             FALSE
292             FALSE
293             FALSE
294             FALSE
295             FALSE
296             FALSE
297             FALSE
298             FALSE
299             FALSE
300             FALSE
301             FALSE
302             FALSE
303             FALSE
304             FALSE
305             FALSE
306             FALSE
307             FALSE
308             FALSE
309             FALSE
310             FALSE
311             FALSE
312             FALSE
313             FALSE
314             FALSE
315             FALSE
316             FALSE
317             FALSE
318             FALSE
319             FALSE
320             FALSE
321             FALSE
322             FALSE
323             FALSE
324             FALSE
325             FALSE
326             FALSE
327             FALSE
328             FALSE
329             FALSE
330             FALSE
331             FALSE
332             FALSE
333             FALSE
334             FALSE
335             FALSE
336             FALSE
337             FALSE
338             FALSE
339             FALSE
340             FALSE
341             FALSE
342             FALSE
343             FALSE
344             FALSE
345             FALSE
346             FALSE
347             FALSE
348             FALSE
349             FALSE
350             FALSE
351             FALSE
352             FALSE
353             FALSE
354             FALSE
355             FALSE
356             FALSE
357             FALSE
358             FALSE
359             FALSE
360             FALSE
361             FALSE
362             FALSE
363             FALSE
364             FALSE
365             FALSE
366             FALSE
367             FALSE
368             FALSE
369             FALSE
370             FALSE
371             FALSE
372             FALSE
373             FALSE
374             FALSE
375             FALSE
376             FALSE
377             FALSE
378             FALSE
379             FALSE
380             FALSE
381             FALSE
382             FALSE
383             FALSE
384             FALSE
385             FALSE
386             FALSE
387             FALSE
388             FALSE
389             FALSE
390             FALSE
391             FALSE
392             FALSE
393             FALSE
394             FALSE
395             FALSE
396             FALSE
397             FALSE
398             FALSE
399             FALSE
400             FALSE
401             FALSE
402             FALSE
403             FALSE
404             FALSE
405             FALSE
406             FALSE
407             FALSE
408             FALSE
409             FALSE
410             FALSE
411             FALSE
412             FALSE
413             FALSE
414             FALSE
415             FALSE
416             FALSE
417             FALSE
418             FALSE


> linmod <- lm(Fare ~ Pclass + Age + SibSp + Parch)

> impute <- function(a, a.impute) {
+ ifelse(is.na(a), a.impute, a)
+ }

> predictFare <- predict(linmod, missing)
> impute(mydat$Fare, predictFare)
  [1]   7.829200   7.000000   9.687500   8.662500  12.287500   9.225000   7.629200  29.000000   7.229200
 [10]  24.150000   7.895800  26.000000  82.266700  26.000000  61.175000  27.720800  12.350000   7.225000
 [19]   7.925000   7.225000  59.400000   3.170800  31.683300  61.379200 262.375000  14.500000  61.979200
 [28]   7.225000  30.500000  21.679200  26.000000  31.500000  20.575000  23.450000  57.750000   7.229200
 [37]   8.050000   8.662500   9.500000  56.495800  13.416700  26.550000   7.850000  13.000000  52.554200
 [46]   7.925000  29.700000   7.750000  76.291700  15.900000  60.000000  15.033300  23.000000 263.000000
 [55]  15.579200  29.125000   7.895800   7.650000  16.100000 262.375000   7.895800  13.500000   7.750000
 [64]   7.725000 262.375000  21.000000   7.879200  42.400000  28.537500 263.000000   7.750000   7.895800
 [73]   7.925000  27.720800 211.500000 211.500000   8.050000  25.700000  13.000000   7.750000  15.245800
 [82] 221.779200  26.000000   7.895800  10.708300  14.454200   7.879200   8.050000   7.750000  23.000000
 [91]  13.900000   7.775000  52.000000   8.050000  26.000000   7.795800  78.850000   7.925000   7.854200
[100]   8.050000  55.441700  26.000000   7.750000   7.775000   8.516700  22.525000   7.820800   7.750000
[109]   8.712500  13.000000  15.045800   7.779200  31.679200   7.283300 221.779200  14.454200   6.437500
[118]  16.700000  75.241700  26.000000  15.750000   7.750000  57.750000   7.250000   7.750000  16.100000
[127]   7.795800  23.250000  13.000000   8.050000   8.050000  28.500000  25.466700   6.437500   7.895800
[136]   7.854200   7.225000  13.000000   8.050000  46.900000  46.900000 151.550000 262.375000  26.000000
[145]  26.550000  18.000000  51.862500   8.050000  26.550000  26.000000  83.158300   7.895800   9.160766
[154]  12.183300  31.387500   7.550000 221.779200   7.854200  26.550000  13.775000   7.733300  15.245800
[163]  13.500000   7.000000  13.000000  22.025000  50.495800  34.375000  27.720800   8.962500   7.550000
[172]   7.225000  13.900000   7.229200  31.387500  39.000000  36.750000  55.441700  39.000000  83.158300
[181]  13.000000  83.158300  53.100000   7.750000 247.520800  16.000000  21.000000   8.050000  69.550000
[190]  13.000000  26.000000  26.000000  14.500000  12.350000  32.500000   7.854200 134.500000   7.775000
[199]  10.500000   8.112500  15.500000  14.400000 227.525000  26.000000  10.500000  25.741700   7.750000
[208]  10.500000  27.720800   7.895800  22.525000   7.050000  73.500000  26.000000   7.775000  42.500000
[217]   7.879200 164.866700 211.500000   8.050000  13.858300   8.050000  10.500000   7.795800  27.445800
[226]  15.245800   7.795800   7.750000  15.100000  13.000000  65.000000  26.550000   6.495800   7.879200
[235]  71.283300   7.854200  75.250000   7.225000  13.000000 106.425000  27.720800  30.000000 134.500000
[244]   7.887500  23.450000  51.862500  21.000000  32.500000  26.000000  14.454200  27.750000   7.925000
[253] 136.779200   9.325000   9.500000   7.550000   7.750000   8.050000  13.000000   7.775000  17.400000
[262]   7.854200  23.000000  12.183300  12.737500   7.895800   0.000000   7.550000   8.050000   8.662500
[271]  75.241700   7.750000 136.779200  15.500000   7.225000  26.000000  10.500000  26.000000  21.000000
[280]  10.500000   8.662500  13.775000   7.750000  15.245800  20.212500   7.250000   7.250000  82.266700
[289]   7.229200   8.050000  39.600000   6.950000   7.229200  81.858300   9.500000   7.895800  41.579200
[298]  21.679200  45.500000   7.854200   7.775000  15.045800  21.000000   8.662500   7.750000  26.550000
[307] 151.550000   9.350000  93.500000  14.108300   8.662500   7.225000   7.575000   7.750000 135.633300
[316]   7.733300 146.520800  10.500000   7.854200  31.500000   7.775000   7.229200  13.000000  26.550000
[325] 211.337500   7.050000  39.000000  79.200000  26.000000  13.000000  36.750000  29.700000   7.225000
[334]  15.741700   7.895800  26.000000  13.000000   7.229200  31.500000   7.229200  10.500000   7.579200
[343]  69.550000 512.329200  14.500000   7.650000  13.000000   7.229200  13.500000  21.000000  63.358300
[352]  10.500000  73.500000  65.000000  20.575000  26.000000  51.479200   7.879200   7.750000  15.550000
[361]  69.550000  37.004200  21.000000   8.662500  55.441700  69.550000  14.458300  39.687500  59.400000
[370]  13.858300  11.500000 134.500000   0.000000  13.000000  81.858300 262.375000   8.662500  11.500000
[379]  50.000000  31.387500   7.750000   7.879200  14.500000  16.100000  12.875000  65.000000   7.775000
[388]  13.000000   7.750000  21.075000  93.500000  39.400000  20.250000  10.500000  22.025000  60.000000
[397]   7.250000  79.200000   7.775000   7.733300 164.866700  21.000000  59.400000  47.100000  27.720800
[406]  13.862500  10.500000 211.500000   7.720800  13.775000   7.750000  90.000000   7.775000   8.050000
[415] 108.900000   7.250000   8.050000  22.358300


> mydat["Fare"] <- newFare



> kde = density(mydat$Fare, na.rm = TRUE)


> jpeg("C:/Users/USER/Desktop/Notes/COMP 331/Project/kde.jpg")
> plot(kde)
> dev.off()
null device 
          1 



> jpeg("C:/Users/USER/Desktop/Notes/COMP 331/Project/scatterplot.jpg")
> plot(x, y)
> dev.off()
null device 
          1 
> 